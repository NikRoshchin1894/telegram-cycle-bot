#!/bin/bash

# üöÄ –°–∫—Ä–∏–ø—Ç –¥–ª—è –¥–µ–ø–ª–æ—è –±–æ—Ç–∞ –Ω–∞ Render
# –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø–æ–º–æ–∂–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –¥–ª—è –¥–µ–ø–ª–æ—è

echo "üöÄ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –¥–µ–ø–ª–æ—é –Ω–∞ Render..."

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
if [ ! -f "package.json" ]; then
    echo "‚ùå –û—à–∏–±–∫–∞: package.json –Ω–µ –Ω–∞–π–¥–µ–Ω. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞."
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º Git —Å—Ç–∞—Ç—É—Å
echo "üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ Git —Å—Ç–∞—Ç—É—Å–∞..."
if ! git status > /dev/null 2>&1; then
    echo "‚ùå –û—à–∏–±–∫–∞: Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω."
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã
if ! git diff --quiet || ! git diff --cached --quiet; then
    echo "‚ö†Ô∏è  –í–Ω–∏–º–∞–Ω–∏–µ: –ï—Å—Ç—å –Ω–µ–∑–∞–∫–æ–º–º–∏—á–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è."
    echo "–ó–∞–ø—É—Å—Ç–∏—Ç–µ: git add . && git commit -m 'Prepare for deployment'"
    exit 1
fi

echo "‚úÖ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≥–æ—Ç–æ–≤."

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤
echo "üìÅ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –¥–µ–ø–ª–æ—è..."

required_files=("package.json" "Procfile" "render.yaml" ".gitignore")
for file in "${required_files[@]}"; do
    if [ ! -f "$file" ]; then
        echo "‚ùå –û—à–∏–±–∫–∞: –§–∞–π–ª $file –Ω–µ –Ω–∞–π–¥–µ–Ω."
        exit 1
    fi
done

echo "‚úÖ –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç."

# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
echo ""
echo "üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –¥–ª—è –¥–µ–ø–ª–æ—è –Ω–∞ Render:"
echo ""
echo "1. üìù –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub:"
echo "   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ github.com"
echo "   - –ù–∞–∂–º–∏—Ç–µ 'New repository'"
echo "   - –ù–∞–∑–≤–∞–Ω–∏–µ: telegram-cycle-bot"
echo "   - –°–¥–µ–ª–∞–π—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–º"
echo ""
echo "2. üîó –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —É–¥–∞–ª–µ–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:"
echo "   git remote add origin https://github.com/YOUR_USERNAME/telegram-cycle-bot.git"
echo "   git push -u origin main"
echo ""
echo "3. üåê –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –Ω–∞ Render:"
echo "   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ render.com"
echo "   - –í–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ GitHub"
echo "   - –°–æ–∑–¥–∞–π—Ç–µ Web Service"
echo "   - –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π"
echo ""
echo "4. üîß –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:"
echo "   TELEGRAM_BOT_TOKEN=your_bot_token_here"
echo "   OPENAI_API_KEY=your_openai_api_key_here"
echo "   DATABASE_PATH=/opt/render/project/src/data/bot.db"
echo "   TIMEZONE=Europe/Moscow"
echo "   NOTIFICATION_TIME=09:00"
echo "   NODE_ENV=production"
echo ""
echo "5. üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–µ–ø–ª–æ–π –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –±–æ—Ç–∞!"
echo ""
echo "üìñ –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ —Ñ–∞–π–ª–µ: RENDER_DEPLOY_STEPS.md"
echo ""
echo "‚úÖ –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é –Ω–∞ Render!"
