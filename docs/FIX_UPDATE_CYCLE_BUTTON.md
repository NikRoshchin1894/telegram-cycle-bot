# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ "–û–±–Ω–æ–≤–∏—Ç—å —Ü–∏–∫–ª"

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

–ö–Ω–æ–ø–∫–∞ "üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞—Ç—É" –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏ —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–∞—Ç—ã –≤ –∫–æ–º–∞–Ω–¥–µ `/updatecycle`.

### **–°–∏–º–ø—Ç–æ–º—ã:**
- –ö–Ω–æ–ø–∫–∞ –Ω–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–ª–∞ –Ω–∞ –Ω–∞–∂–∞—Ç–∏—è
- –û—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–∏–∫–ª–∞
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–∏—Ç—å –¥–∞—Ç—É –Ω–∞—á–∞–ª–∞ —Ü–∏–∫–ª–∞

### **–ü—Ä–∏—á–∏–Ω–∞:**
–û—à–∏–±–∫–∞ –≤ —Å—Ç—Ä–æ–∫–µ –∫–æ–¥–∞: `user.lastCycleDate.toLocaleDateString('ru-RU')`
- `lastCycleDate` –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏—Ö–æ–¥–∏—Ç –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞
- –ú–µ—Ç–æ–¥ `toLocaleDateString()` —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –æ–±—ä–µ–∫—Ç–∞–º–∏ Date

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ —Å –¥–∞—Ç–æ–π:**

#### **–ë—ã–ª–æ:**
```javascript
‚Ä¢ –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: ${user.lastCycleDate.toLocaleDateString('ru-RU')}
```

#### **–°—Ç–∞–ª–æ:**
```javascript
‚Ä¢ –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: ${new Date(user.lastCycleDate).toLocaleDateString('ru-RU')}
```

### **–ü–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∫–Ω–æ–ø–∫–∏ "–û–±–Ω–æ–≤–∏—Ç—å —Ü–∏–∫–ª":**

#### **1. –ö–Ω–æ–ø–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã "üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞—Ç—É":**
- ‚úÖ –≠–º—É–ª–∏—Ä—É–µ—Ç –∫–æ–º–∞–Ω–¥—É `/updatecycle`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ü–∏–∫–ª–µ
- ‚úÖ –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤—ã–±–æ—Ä–∞ —Å–ø–æ—Å–æ–±–∞ –≤–≤–æ–¥–∞

#### **2. Inline –∫–Ω–æ–ø–∫–∞ "üîÑ –û–±–Ω–æ–≤–∏—Ç—å":**
- ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ `isUpdate: true`
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –≤—ã–±–æ—Ä–∞ —Å–ø–æ—Å–æ–±–∞ –≤–≤–æ–¥–∞
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏ —Ä—É—á–Ω–æ–π –≤–≤–æ–¥

## üéØ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### **–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ "üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞—Ç—É":**

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:**
   ```javascript
   const user = await database.getUser(chatId);
   if (!user) {
     await bot.sendMessage(chatId, '‚ùå –í—ã –µ—â–µ –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã...');
     return;
   }
   ```

2. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:**
   ```javascript
   const currentCycleDay = cycleTracker.getCycleDay(user.lastCycleDate);
   const currentPhase = cycleTracker.getCyclePhase(currentCycleDay);
   ```

3. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:**
   ```
   üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞—Ç—ã —Ü–∏–∫–ª–∞

   üìä –¢–µ–∫—É—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:
   ‚Ä¢ –î–µ–Ω—å —Ü–∏–∫–ª–∞: 15
   ‚Ä¢ –§–∞–∑–∞: –û–≤—É–ª—è—Ü–∏—è
   ‚Ä¢ –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 07.10.2024

   ‚ö†Ô∏è –≠—Ç–æ –æ–±–Ω–æ–≤–∏—Ç –≤–µ—Å—å —Ä–∞—Å—á–µ—Ç –≤–∞—à–µ–≥–æ —Ü–∏–∫–ª–∞!
   ```

4. **–ü–æ–∫–∞–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –≤—ã–±–æ—Ä–∞ —Å–ø–æ—Å–æ–±–∞:**
   ```javascript
   await showDateSelectionMenu(chatId, true);
   ```

### **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤—ã–±–æ—Ä–∞ —Å–ø–æ—Å–æ–±–∞ –≤–≤–æ–¥–∞:**

```
üìÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞—Ç—ã —Ü–∏–∫–ª–∞

–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –≤–≤–æ–¥–∞ –Ω–æ–≤–æ–π –¥–∞—Ç—ã:

üóìÔ∏è –°–µ–≥–æ–¥–Ω—è: 07.10.2024

üí° –í—ã–±–µ—Ä–∏—Ç–µ —É–¥–æ–±–Ω—ã–π –¥–ª—è –≤–∞—Å —Å–ø–æ—Å–æ–±:

üìÖ **–ö–∞–ª–µ–Ω–¥–∞—Ä—å** - –≤–∏–∑—É–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
‚úèÔ∏è **–†—É—á–Ω–æ–π –≤–≤–æ–¥** - –≤–≤–µ–¥–∏—Ç–µ –¥–∞—Ç—É –≤ —Ñ–æ—Ä–º–∞—Ç–µ –î–î.–ú–ú.–ì–ì–ì–ì

[üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å] [‚úèÔ∏è –í–≤–µ—Å—Ç–∏ –≤—Ä—É—á–Ω—É—é]
[üîô –ù–∞–∑–∞–¥]
```

## üéÆ –í–∞—Ä–∏–∞–Ω—Ç—ã –≤–≤–æ–¥–∞ –¥–∞—Ç—ã

### **1. –ß–µ—Ä–µ–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—å:**
- ‚úÖ –ü–æ–ª–Ω—ã–π –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å
- ‚úÖ –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –º–µ—Å—è—Ü–∞–º –∫–Ω–æ–ø–∫–∞–º–∏ ‚óÄÔ∏è ‚ñ∂Ô∏è
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–µ –∫–Ω–æ–ø–∫–∏ "–°–µ–≥–æ–¥–Ω—è" –∏ "–í—á–µ—Ä–∞"
- ‚úÖ –í–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –¥–∞—Ç

### **2. –†—É—á–Ω–æ–π –≤–≤–æ–¥:**
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ñ–æ—Ä–º–∞—Ç—É
- ‚úÖ –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –≤–≤–æ–¥–∞
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞—Ç
- ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—å

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã:**
```javascript
bot.onText(/^(üìä –ú–æ–π —Ü–∏–∫–ª|üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞—Ç—É)$/, async (msg) => {
  if (text === 'üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞—Ç—É') {
    // –≠–º—É–ª–∏—Ä—É–µ–º –∫–æ–º–∞–Ω–¥—É /updatecycle
    msg.text = '/updatecycle';
    bot.emit('message', msg);
    return;
  }
});
```

### **–û–±—Ä–∞–±–æ—Ç–∫–∞ inline –∫–Ω–æ–ø–∫–∏:**
```javascript
case 'updatecycle':
  await bot.answerCallbackQuery(callbackQuery.id, { text: '–ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è' });
  
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —á—Ç–æ —ç—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
  userStates.set(chatId, { isUpdate: true });
  
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –≤—ã–±–æ—Ä–∞ —Å–ø–æ—Å–æ–±–∞ –≤–≤–æ–¥–∞ –¥–∞—Ç—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
  await showDateSelectionMenu(chatId, true);
  break;
```

### **–ö–æ–º–∞–Ω–¥–∞ /updatecycle:**
```javascript
bot.onText(/\/updatecycle/, async (msg) => {
  const user = await database.getUser(chatId);
  
  if (!user) {
    await bot.sendMessage(chatId, '‚ùå –í—ã –µ—â–µ –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã...');
    return;
  }
  
  // –ü–æ–∫–∞–∑ —Ç–µ–∫—É—â–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
  // –ü–æ–∫–∞–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –≤—ã–±–æ—Ä–∞ —Å–ø–æ—Å–æ–±–∞ –≤–≤–æ–¥–∞
  await showDateSelectionMenu(chatId, true);
});
```

## üöÄ –†–µ–∑—É–ª—å—Ç–∞—Ç

### **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ‚ùå –ö–Ω–æ–ø–∫–∞ "–û–±–Ω–æ–≤–∏—Ç—å –¥–∞—Ç—É" –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∞
- ‚ùå –û—à–∏–±–∫–∏ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–∏–∫–ª–∞
- ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–∏—Ç—å –¥–∞—Ç—É

### **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞—Ç—É" —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ü–∏–∫–ª–µ
- ‚úÖ –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤—ã–±–æ—Ä–∞ —Å–ø–æ—Å–æ–±–∞ –≤–≤–æ–¥–∞
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏ —Ä—É—á–Ω–æ–π –≤–≤–æ–¥
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞—Ç—É —Ü–∏–∫–ª–∞

## üé® –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç

### **–ü—Ä–æ—Ü–µ—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–∏–∫–ª–∞:**

1. **–ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏** "üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞—Ç—É"
2. **–ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–∫—É—â–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏** –æ —Ü–∏–∫–ª–µ
3. **–í—ã–±–æ—Ä —Å–ø–æ—Å–æ–±–∞ –≤–≤–æ–¥–∞** (–∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–ª–∏ —Ä—É—á–Ω–æ–π –≤–≤–æ–¥)
4. **–í–≤–æ–¥ –Ω–æ–≤–æ–π –¥–∞—Ç—ã** –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º
5. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** —Å –Ω–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ü–∏–∫–ª–µ

### **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- ‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å** - –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ –≤–≤–æ–¥–∞ –¥–∞—Ç—ã
- ‚úÖ **–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç—å** - –ø–æ–∫–∞–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### **–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:**
1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏**: `cat bot.log`
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é**: –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞—Ç

### **–õ–æ–≥–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:**
```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
tail -f bot.log
```

---

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ö–Ω–æ–ø–∫–∞ "üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞—Ç—É" —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–∏–∫–ª–∞ —á–µ—Ä–µ–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–ª–∏ —Ä—É—á–Ω–æ–π –≤–≤–æ–¥!
