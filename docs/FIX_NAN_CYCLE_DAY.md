# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ "NaN –∏–∑ 28 –¥–Ω–µ–π"

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ "üìä –ú–æ–π —Ü–∏–∫–ª" –æ—Ç–æ–±—Ä–∞–∂–∞–ª–æ—Å—å "**NaN –∏–∑ 28 –¥–Ω–µ–π**" –≤–º–µ—Å—Ç–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞ –¥–Ω—è —Ü–∏–∫–ª–∞.

### **–ü—Ä–∏—á–∏–Ω—ã:**
1. **–ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö**: –§—É–Ω–∫—Ü–∏—è `getCycleDay()` –æ–∂–∏–¥–∞–ª–∞ –æ–±—ä–µ–∫—Ç Date, –Ω–æ –ø–æ–ª—É—á–∞–ª–∞ —Å—Ç—Ä–æ–∫—É –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏**: –ù–µ –±—ã–ª–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
3. **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π –º–µ—Ç–æ–¥**: –ú–µ—Ç–æ–¥ `getNextPhase()` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –≤ –∫–æ–¥–µ, –Ω–æ –Ω–µ –±—ã–ª –æ–ø—Ä–µ–¥–µ–ª–µ–Ω

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `getCycleDay()`**

#### **–ë—ã–ª–æ:**
```javascript
getCycleDay(lastCycleDate) {
  const now = new Date();
  const diffTime = Math.abs(now - lastCycleDate);
  const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
  
  let cycleDay = diffDays % 28;
  if (cycleDay === 0) cycleDay = 28;
  
  return cycleDay;
}
```

#### **–°—Ç–∞–ª–æ:**
```javascript
getCycleDay(lastCycleDate) {
  // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ –æ–±—ä–µ–∫—Ç Date, –µ—Å–ª–∏ —ç—Ç–æ —Å—Ç—Ä–æ–∫–∞
  const cycleStartDate = new Date(lastCycleDate);
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –¥–∞—Ç–∞ –≤–∞–ª–∏–¥–Ω–∞
  if (isNaN(cycleStartDate.getTime())) {
    console.error('Invalid date provided to getCycleDay:', lastCycleDate);
    return 1; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–µ—Ä–≤—ã–π –¥–µ–Ω—å —Ü–∏–∫–ª–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  }
  
  const now = new Date();
  const diffTime = Math.abs(now - cycleStartDate);
  const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
  
  // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –¥–µ–Ω—å —Ü–∏–∫–ª–∞ (1-28)
  let cycleDay = diffDays % 28;
  if (cycleDay === 0) cycleDay = 28;
  
  return cycleDay;
}
```

### 2. **–î–æ–±–∞–≤–ª–µ–Ω –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π –º–µ—Ç–æ–¥ `getNextPhase()`**

```javascript
getNextPhase(cycleDay) {
  const phases = Object.entries(this.phases);
  
  for (let i = 0; i < phases.length; i++) {
    const [phaseName, phaseData] = phases[i];
    if (phaseData.days.includes(cycleDay)) {
      // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–ª–µ–¥—É—é—â—É—é —Ñ–∞–∑—É
      const nextPhaseIndex = (i + 1) % phases.length;
      const [nextPhaseName, nextPhaseData] = phases[nextPhaseIndex];
      
      return {
        name: nextPhaseData.name,
        description: nextPhaseData.description,
        daysUntil: nextPhaseData.days[0] - cycleDay
      };
    }
  }
  
  return null;
}

getNextPhaseInfo(cycleDay) {
  return this.getNextPhase(cycleDay);
}
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤:**
- ‚úÖ **–°—Ç—Ä–æ–∫–∞ ‚Üí Date**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –≤ –æ–±—ä–µ–∫—Ç Date
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –¥–∞—Ç—ã —Å `isNaN()`
- ‚úÖ **Fallback –∑–Ω–∞—á–µ–Ω–∏–µ**: –í–æ–∑–≤—Ä–∞—Ç –¥–Ω—è 1 –ø—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –¥–∞—Ç–µ

### **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫**: –í—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å –ø—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **Graceful degradation**: –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —Å –∑–Ω–∞—á–µ–Ω–∏–µ–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- ‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç —Å–±–æ–µ–≤**: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∫—Ä–∞—à–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
- ‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**: –†–∞–±–æ—Ç–∞–µ—Ç —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏ –∏ –æ–±—ä–µ–∫—Ç–∞–º–∏ Date
- ‚úÖ **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º
- ‚úÖ **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å**: –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –º–µ—Ç–æ–¥—ã

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
üìä –í–∞—à —Ç–µ–∫—É—â–∏–π —Ü–∏–∫–ª:

üìÖ –î–µ–Ω—å —Ü–∏–∫–ª–∞: NaN –∏–∑ 28  ‚ùå
üåô –§–∞–∑–∞: undefined
‚ö° –£—Ä–æ–≤–µ–Ω—å —ç–Ω–µ—Ä–≥–∏–∏: undefined
```

### **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
üìä –í–∞—à —Ç–µ–∫—É—â–∏–π —Ü–∏–∫–ª:

üìÖ –î–µ–Ω—å —Ü–∏–∫–ª–∞: 15 –∏–∑ 28  ‚úÖ
üåô –§–∞–∑–∞: –û–≤—É–ª—è—Ü–∏—è
‚ö° –£—Ä–æ–≤–µ–Ω—å —ç–Ω–µ—Ä–≥–∏–∏: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
üîÆ –°–ª–µ–¥—É—é—â–∞—è —Ñ–∞–∑–∞: –õ—é—Ç–µ–∏–Ω–æ–≤–∞—è —Ñ–∞–∑–∞
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### **–°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
1. **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –¥–∞—Ç–∞**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞—Ç–∞–º–∏
2. **–°—Ç—Ä–æ–∫–∞ –¥–∞—Ç—ã**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫–∏ –≤ Date
3. **–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –¥–∞—Ç–∞**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
4. **–ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–Ω–µ–π 1, 28, –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –º–µ–∂–¥—É —Ü–∏–∫–ª–∞–º–∏

### **–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–Ω—è —Ü–∏–∫–ª–∞ (1-28)
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–∞–∑—ã —Ü–∏–∫–ª–∞
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ä–∞—Å—á–µ—Ç —É—Ä–æ–≤–Ω—è —ç–Ω–µ—Ä–≥–∏–∏
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–π —Ñ–∞–∑—ã

## üöÄ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:**
- ‚úÖ **–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –æ—à–∏–±–∫–∞–º**: –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞**: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ NaN –∏ undefined
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –≤ –ª–æ–≥–∞—Ö

### **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç:**
- ‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è**: –¢–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ —Ü–∏–∫–ª–µ
- ‚úÖ **–ü–æ–Ω—è—Ç–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: –ß–µ—Ç–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–Ω—è —Ü–∏–∫–ª–∞
- ‚úÖ **–ü–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**: –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ:**
- ‚úÖ **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å**: –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –º–µ—Ç–æ–¥—ã
- ‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å**: –ß–µ—Ç–∫–∏–π –∫–æ–¥ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### **–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:**
1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏**: –ü–æ–∏—Å–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö –≤ –∫–æ–Ω—Å–æ–ª–∏
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ**: –£–±–µ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –¥–∞—Ç –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É `getCycleDay()` —Å —Ä–∞–∑–Ω—ã–º–∏ –≤—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

### **–õ–æ–≥–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:**
```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –ø–æ—è–≤–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –¥–∞—Ç–µ:
console.error('Invalid date provided to getCycleDay:', lastCycleDate);
```

---

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ö–Ω–æ–ø–∫–∞ "üìä –ú–æ–π —Ü–∏–∫–ª" —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–µ–Ω—å —Ü–∏–∫–ª–∞ –≤–º–µ—Å—Ç–æ "NaN –∏–∑ 28 –¥–Ω–µ–π"!
